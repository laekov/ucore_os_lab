Lab2 实验报告
===
## 练习零: 合并文件
使用 `git diff` 查找被修改过的文件. 使用 `vimdiff` 合并被修改的文件.
## 练习一: First-fit
### 初始化
在 `default_init_memmap()` 中将所有内存视为一个巨大的块.
### 申请内存
在 `default_alloc_pages()` 中, 挨个查找当前的块是否比请求大. 如果大就选它了.

如果还有剩余的话, 要将这个块插回去. 值得注意的是原有的代码是直接将这块插在链表首, 这是不对的. 应该插在它原来的位置.
### 释放内存
释放时查找内存表. 如果当前这块恰好接在释放块的前面或者后面, 则合并. 如果当前块已经在释放块的后面, 就 `break` 掉.

然后当前的 `le` 一定就是你要插入的位置的后一个元素. 然后利用 `list_add_before()` 就可以把当前块插到正确的位置了.
### 改进
也许可以使用更快的数据结构方法来查找所需要的块.
## 练习二: 寻找对应页表项
### 过程
用 la 的前一段找这个二级页表是否存在. 如果不存在就新建一个页来当二级页表用. 然后把这个一级页表项修改一下然后返回二级页表的地址.
### PDE 组成部分
#### flags
* `P` 用于记录这个二级页表是否存在.
* `W` 用于记录这个页表是否可写? 意义未知
* `U` 用于记录这个页表是否可以从用户态访问.
#### ADDR
二级页表的物理地址
### PTE 组成部分
flags 同.

帧号.
### 页访问异常
抛出错误. 如果允许建立则建立相应的页, 如果有虚拟存储机制则查外存.
## 练习三: 释放二级页表
### 过程
找到这个页的 `Page` 结构, 减少引用次数. 如果引用次数为 `0` 就用相应函数把这个页释放掉. 然后刷新一下 TLB.
### page 和页目录项对应
页目录和页表都是一页, 会被某个 page 记录.
### 虚拟地址与物理地址相等
页表全部映射到实际的物理地址. `index = content`

